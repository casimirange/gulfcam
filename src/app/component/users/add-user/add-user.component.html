
<div class="app-page-title" *ngIf="role.includes('ROLE_SUPERADMIN')">
  <div class="page-title-wrapper">
    <div class="page-title-heading">
      <div class="page-title-icon">
        <i class="pe-7s-user icon-gradient bg-danger">
        </i>
      </div>
      <div>Nouvel utilisateur
        <div class="page-title-subheading">Enregistrer de nouveaux utilisateurs</div>
      </div>
    </div>
    <div class="page-title-actions">
      <button (click)="back()" type="button" data-toggle="tooltip" title="cartons" data-placement="bottom"
              class="btn-shadow mr-3 btn btn-outline-dark">
           <span class="btn-icon-wrapper pr-2 opacity-7">
                                            <i class="fa fa-backward fa-w-20"></i>
                                        </span>
        Retour
      </button>
    </div>
<!--    <div class="page-title-actions">-->
<!--      <div class="d-inline-block ">-->
<!--        <button  type="button" data-toggle="tooltip" title="supprimer utilisateur" class="btn-shadow btn btn-danger mr-3">-->
<!--                                        <span class="btn-icon-wrapper pr-2 opacity-7">-->
<!--                                            <i class="fa fa-times fa-w-20"></i>-->
<!--                                        </span>-->
<!--          supprimer-->
<!--        </button>-->
<!--        <button  type="button" data-toggle="tooltip" title="modifier utilisateur" class="btn-shadow btn btn-primary mr-3">-->
<!--                                        <span class="btn-icon-wrapper pr-2 opacity-7">-->
<!--                                            <i class="fa fa-times fa-w-20"></i>-->
<!--                                        </span>-->
<!--          modifier-->
<!--        </button>-->
<!--      </div>-->
<!--    </div>-->
  </div>
</div>

<!--<ul class="body-tabs body-tabs-layout tabs-animated body-tabs-animated nav">-->

<!--  <li class="nav-item">-->
<!--    <a role="tab" class="nav-link" id="tab-1" data-toggle="tab" href="#tab-content-1">-->
<!--      <span>Modifier</span>-->
<!--    </a>-->
<!--  </li>-->
<!--</ul>-->

<div class="tab-content" *ngIf="role.includes('ROLE_SUPERADMIN')">
  <div class="" id="tab-content-1" >
    <div class="row">
      <div class="col-md-12">
        <div class="main-card mb-3 card">
          <div class="card-body">
            <h5 class="card-title">Nouvel utilisateur</h5>
            <form [formGroup]="signup">
              <div class="form-row">
                <div class="col-md-6">
                  <div class="position-relative form-group">
                    <label>Email</label>
                    <input id="exampleEmail" placeholder="Email..." type="email" name="email" class="form-control form-control-sm"
                           formControlName="email" >
                  </div>
                  <div *ngIf="form['email'].invalid && (form['email'].dirty || form['email'].touched)"
                       class="mb-2"  style="color: #f65656; font-style: italic;">

                    <div *ngIf="form['email'].errors?.['required']" class="ml-3">
                      l'email est obligatoire.
                    </div>
                    <div *ngIf="form['email'].errors?.['email']" class="ml-3">
                      entrez une email valide : example@example.com
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="position-relative form-group">
                    <label>Téléphone</label>
                    <input id="telephone" placeholder="téléphone..." type="text" name="telephone" class="form-control form-control-sm"
                           formControlName="telephone" >
                  </div>
                  <div *ngIf="form['telephone'].invalid && (form['telephone'].dirty || form['telephone'].touched)"
                       class="mb-2"  style="color: #f65656; font-style: italic;">

                    <div *ngIf="form['telephone'].errors?.['required']" class="ml-3">
                      le numéro de téléphone est obligatoire.
                    </div>
                    <div *ngIf="form['telephone'].errors?.['pattern']" class="ml-3">
                      Le numéro de téléphone doit comporter 9 chiffres commençant par 2 ou par 6
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="position-relative form-group">
                    <label>Code pin</label>
                    <input id="pinCode" placeholder="Code pin" type="text" name="pinCode" class="form-control form-control-sm"
                           formControlName="pinCode" >
                  </div>
                  <div *ngIf="form['pinCode'].invalid && (form['pinCode'].dirty || form['pinCode'].touched)"
                       class="mb-2"  style="color: #f65656; font-style: italic;">

                    <div *ngIf="form['pinCode'].errors?.['required']" class="ml-3">
                      le code pin est obligatoire.
                    </div>
                    <div *ngIf="form['pinCode'].errors?.['pattern']" class="ml-3">
                      Le code pin est un nombre
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="position-relative form-group">
                    <!--                        <input id="idStore" placeholder="Magasin" type="text" name="idStore" class="form-control form-control-sm"  formControlName="idStore">-->
                    <!--                    <input type="text" id="clientref" class="form-control" formControlName="idStore" placeholder="choisir un magasin" -->
                    <!--                           list="storeListOption"  [(ngModel)]="user.idStore">-->
                    <label>Magasin</label>
<!--                    <select formControlName="idStore" class="form-control form-control-sm">-->
<!--                      <option *ngFor="let store of stores" [value]="user.idStore">{{store.localization}}</option>-->
<!--                    </select>-->
                    <input type="text" id="tb" placeholder="Sélectionner un magasin" autocomplete="off" class="form-control form-control-sm"
                           formControlName="idStore" list="storeListOption">
                    <datalist id="storeListOption">
<!--                      <option value="" selected disabled hidden></option>-->
                      <option *ngFor="let store of stores" [value]="store.localization"></option>
                    </datalist>
                  </div>
                  <div *ngIf="form['idStore'].invalid && (form['idStore'].dirty || form['idStore'].touched)"
                       class="mb-2"  style="color: #f65656; font-style: italic;">

                    <div *ngIf="form['idStore'].errors?.['required']" class="ml-3">
                      le magasin est obligatoire.
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="position-relative form-group">
                    <label>Mot de passe</label>
                    <input  id="examplePassword" name="pwd" placeholder="Mot de passe" type="password" class="form-control form-control-sm" formControlName="password"></div>
                  <div *ngIf="form['password'].invalid && (form['password'].dirty || form['password'].touched)"
                       class=""  style="color: #f65656; font-style: italic;">

                    <div *ngIf="form['password'].errors?.['required']" class="ml-3">
                      le mot de passe est obligatoire.
                    </div>
                    <div *ngIf="form['password'].errors?.['pattern']" class="ml-3">
                      au moins 8 caractères avec 1 minuscule, 1 majuscule et 1 caractère spécial
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="position-relative form-group">
                    <label>Nom</label>
                    <input  id="firstName" placeholder="Nom" type="text" class="form-control form-control-sm" formControlName="firstName"
                            ></div>
                  <div *ngIf="form['firstName'].invalid && (form['firstName'].dirty || form['firstName'].touched)"
                       class=""  style="color: #f65656; font-style: italic;">

                    <div *ngIf="form['firstName'].errors?.['required']" class="ml-3">
                      le nom est obligatoire.
                    </div>
                    <div *ngIf="form['firstName'].errors?.['minlength']" class="ml-3">
                      le nom doit comporter au moins 4 caractères..
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="position-relative form-group">
                    <label>Prénom</label>
                    <input  id="lastName" placeholder="Prénom" type="text" class="form-control form-control-sm" formControlName="lastName"
                            ></div>
                  <div *ngIf="form['lastName'].invalid && (form['lastName'].dirty || form['lastName'].touched)"
                       class=""  style="color: #f65656; font-style: italic;">

                    <div *ngIf="form['lastName'].errors?.['required']" class="ml-3">
                      le prénom est obligatoire.
                    </div>
                    <div *ngIf="form['lastName'].errors?.['minlength']" class="ml-3">
                      le prénom doit comporter au moins 4 caractères..
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="position-relative form-group">
                    <label>Poste</label>
                    <input  id="position" placeholder="Poste occupé" type="text" class="form-control form-control-sm"
                             formControlName="position"></div>
                  <div *ngIf="form['position'].invalid && (form['position'].dirty || form['position'].touched)"
                       class=""  style="color: #f65656; font-style: italic;">

                    <div *ngIf="form['position'].errors?.['required']" class="ml-3">
                      le nom est obligatoire.
                    </div>
                    <div *ngIf="form['position'].errors?.['minlength']" class="ml-3">
                      le nom doit comporter au moins 4 caractères..
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="position-relative form-group">
                    <label for="position">Type de compte</label>
<!--                                        <input  id="position" placeholder="Poste occupé" type="text" class="form-control form-control-sm"-->
<!--                                                 formControlName="typeAccount">-->
                    <select formControlName="typeAccount" class="form-control form-control-sm">
                      <option value="" selected disabled hidden>Sélectionner un type de compte</option>-->
                      <option value="MANAGER_SPACES_1">Gestionnaire espace 1 </option>
                      <option value="MANAGER_SPACES_2">Gestionnaire espace 2 </option>
                      <option value="SALES_MANAGER">Directeur Commercial </option>
                      <option value="COMMERCIAL_ATTACHE">Attaché Commercial </option>
                      <option value="TREASURY">Caissier/Trésorier</option>
                      <option value="COMPTABLE">Comptable</option>
                      <option value="MANAGER_STATION">Gestionnaire de station</option>
                      <option value="DSI_AUDIT">DSI/AUDIT</option>
                    </select>
                  </div>
                  <div *ngIf="form['typeAccount'].invalid && (form['typeAccount'].dirty || form['typeAccount'].touched)"
                       class=""  style="color: #f65656; font-style: italic;">

<!--                    <div *ngIf="form['typeAccount'].errors?.['required']" class="ml-3">-->
<!--                      le type de compte est obligatoire.-->
<!--                    </div>-->
<!--                    <div *ngIf="form['typeAccount'].errors?.['minlength']" class="ml-3">-->
<!--                      le nom doit comporter au moins 4 caractères...-->
<!--                    </div>-->
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="position-relative form-group">
                    <label for="position">Rôle</label>
<!--                                        <input  id="position" placeholder="Rôle" type="text" class="form-control form-control-sm"-->
<!--                                                 formControlName="role">-->
                    <select formControlName="roleName" class="form-control form-control-sm">
                      <option value="" selected disabled hidden>Sélectionner un rôle</option>
                      <option value="ROLE_SUPERADMIN">Administrateur </option>
<!--                      <option value="ROLE_AGENT">Agent </option>-->
<!--                      <option value="ROLE_SUPERADMIN">Super admin</option>-->
                      <option value="ROLE_USER">Simple utilisateur</option>
                    </select>
                  </div>
                  <div *ngIf="form['roleName'].invalid && (form['roleName'].dirty || form['roleName'].touched)"
                       class=""  style="color: #f65656; font-style: italic;">

<!--                    <div *ngIf="form['role'].errors?.['required']" class="ml-3">-->
<!--                      le nom est obligatoire.-->
<!--                    </div>-->
<!--                    <div *ngIf="form['typeAccount'].errors?.['minlength']" class="ml-3">-->
<!--                      le nom doit comporter au moins 4 caractères...-->
<!--                    </div>-->
                  </div>
                </div>


              </div>
              <div class="row">
              <div class="float-right">
                <button type="submit" class="btn btn-primary" [disabled]="signup.invalid || (isLoading$ | async)"  (click)="saveUser()">
                  <i *ngIf="isLoading$ | async" class="fa fa-spinner fa-spin"></i>&nbsp;
                  <span *ngIf="isLoading$ | async">Enregistrement...</span>
                  <span *ngIf="!(isLoading$ | async)">Enregistrer</span>
                </button>
              </div>
            </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

